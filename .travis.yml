language: bash
sudo: required

services:
  - docker

testSmokeCy: &testSmokeCy
  install:
  - docker run --rm -it -v $PWD:/e2e -w /e2e -e CYPRESS_RECORD_KEY=$CY_KEY cypress/included:3.4.0 --record --parallel --group 2x-chrome --ci-build-id TRAVIS_BUILD_ID --browser chrome
  - kill $(jobs -p) || true

jobs:
  fast_finish: true
  allow_failures:
  include:
  - script:
    name: "Cypress Container 1"
    <<: *testSmokeCy
  - script:
    name: "Cypress Container 2"
    <<: *testSmokeCy  
  - script:
    name: "Cypress Container 3"
    <<: *testSmokeCy

notifications: 
  email:
    recipients:
      - gb8may@gmail.com
      
    on_success: never
    on_failure: never

cache:
  apt: true
  docker: true
  directories:
  - ~/.docker
  - ~/.cache
